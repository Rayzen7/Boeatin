import{W as y,r as n,j as e,a as N}from"./app-lY45AIX9.js";import{r as v,s as U,u as P,g as S}from"./firebase-BrFWFcvJ.js";import{S as i}from"./sweetalert2.all-opkTSmCx.js";const L=({product:r})=>{const{data:t,setData:c,put:x,processing:g,errors:C}=y({nama:r.nama||"",deskripsi:r.deskripsi||"",harga:r.harga||"",link:r.link||"",img_Url:r.img_Url||"",kategori:r.kategori||""}),[o,p]=n.useState(null),[b,f]=n.useState(r.img_Url||""),[d,m]=n.useState(!1);n.useEffect(()=>{if(o){const a=URL.createObjectURL(o);f(a)}},[o]);const l=a=>{c(a.target.name,a.target.value)},j=a=>{const s=a.target.files[0];s&&(p(s),k(s))},k=a=>{m(!0);const s=v(U,`products/${a.name}`),h=P(s,a);h.on("state_changed",null,u=>{console.error("Kesalahan saat mengupload:",u),i.fire("Gagal mengupload gambar","Silakan coba lagi","error"),m(!1)},async()=>{const u=await S(h.snapshot.ref);c("img_Url",u),m(!1),i.fire("Gambar berhasil diupload!","Gambar telah diperbarui.","success")})},w=async a=>{a.preventDefault();try{await x(`/products/${r.id}`,{...t}),i.fire({title:"Sukses!",text:"Produk berhasil diperbarui!",icon:"success",confirmButtonText:"OK"}).then(()=>{window.location.href="/dashboard"})}catch(s){console.error("Error updating product:",s),i.fire("Kesalahan","Gagal memperbarui produk. Silakan coba lagi.","error")}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 my-20",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-lg lg:w-full w-[320px] my-16",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6 text-center",children:"Edit Produk"}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nama Produk"}),e.jsx("input",{type:"text",name:"nama",value:t.nama,onChange:l,className:"mt-1 p-2 border border-gray-300 rounded-md w-full",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Deskripsi"}),e.jsx("textarea",{name:"deskripsi",value:t.deskripsi,onChange:l,className:"mt-1 p-2 border border-gray-300 rounded-md w-full h-28",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Harga"}),e.jsx("input",{type:"number",name:"harga",value:t.harga,onChange:l,className:"mt-1 p-2 border border-gray-300 rounded-md w-full",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Link Produk"}),e.jsx("input",{type:"url",name:"link",value:t.link,onChange:l,className:"mt-1 p-2 border border-gray-300 rounded-md w-full",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Kategori"}),e.jsx("input",{type:"text",name:"kategori",value:t.kategori,onChange:l,className:"mt-1 p-2 border border-gray-300 rounded-md w-full",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Gambar Produk"}),e.jsx("input",{type:"file",onChange:j,className:"mt-1 w-full",accept:"image/*"}),b&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:b,alt:"Preview",className:"w-full h-auto rounded-lg"})})]}),e.jsx("button",{type:"submit",disabled:g||d,className:`w-full p-2 rounded-md font-semibold text-white ${g||d?"bg-gray-300":"bg-blue-600 hover:bg-blue-700"} transition duration-300`,children:d?"Mengupload...":"Update Produk"})]}),e.jsx(N,{href:route("dashboard"),children:e.jsx("button",{className:"w-full mt-4 p-2 rounded-md bg-red-600 text-white font-semibold",children:"Batal"})})]})})};export{L as default};
