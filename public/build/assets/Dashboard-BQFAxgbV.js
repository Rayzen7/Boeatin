import{W as g,r as o,j as e,a as i,Y as j}from"./app-CAXOAY3h.js";import{A as b}from"./AuthenticatedLayout-ChI0ui2B.js";import{S as n}from"./sweetalert2.all-XjPwqVhV.js";import"./transition-CAYI7mmp.js";function v(){const{post:x,delete:l}=g(),[a,c]=o.useState([]),[d,m]=o.useState([]);o.useEffect(()=>{(async()=>{try{const r=await(await fetch("/products")).json();c(r)}catch(s){console.error("Error fetching products:",s)}})()},[]),o.useEffect(()=>{const t=async()=>{try{const r=(await Promise.all(a.map(async f=>await(await fetch(`/products/${f.id}/comments`)).json()))).flat();m(r)}catch(s){console.error("Error fetching comments:",s)}};a.length>0&&t()},[a]);const h=t=>{t.preventDefault(),x(route("logout"))},u=t=>{n.fire({title:"Apakah Anda yakin?",text:"Produk ini akan dihapus secara permanen!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(s=>{s.isConfirmed&&l(`/products/${t}`,{onSuccess:()=>{c(a.filter(r=>r.id!==t)),n.fire({title:"Dihapus!",text:"Produk telah berhasil dihapus.",icon:"success",confirmButtonColor:"#3085d6",confirmButtonText:"OK"})},onError:()=>{n.fire({title:"Kesalahan!",text:"Gagal menghapus produk. Silakan coba lagi.",icon:"error",confirmButtonColor:"#3085d6",confirmButtonText:"OK"})}})})},p=t=>{n.fire({title:"Apakah Anda yakin?",text:"Komentar ini akan dihapus secara permanen!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(s=>{s.isConfirmed&&l(`/comments/${t}`,{onSuccess:()=>{m(d.filter(r=>r.id!==t)),n.fire({title:"Dihapus!",text:"Komentar telah berhasil dihapus.",icon:"success",confirmButtonColor:"#3085d6",confirmButtonText:"OK"})},onError:()=>{n.fire({title:"Kesalahan!",text:"Gagal menghapus komentar. Silakan coba lagi.",icon:"error",confirmButtonColor:"#3085d6",confirmButtonText:"OK"})}})})};return e.jsxs(b,{header:e.jsxs("div",{className:"flex justify-between items-center lg:px-0 px-3",children:[e.jsx("h2",{className:"lg:text-[30px] text-[24px] font-poppins font-[600] leading-tight text-gray-800",children:"Admin"}),e.jsxs("div",{className:"flex justify-center items-center lg:gap-8 font-poppins gap-4",children:[e.jsx(i,{href:route("add"),children:e.jsx("button",{className:"bg-green-600 lg:text-[18px] text-[12px] lg:px-7 px-4 lg:py-3 py-2 rounded-lg text-white font-[600] cursor-pointer hover:bg-green-700",children:"Tambah"})}),e.jsx(i,{href:route("profile.destroy"),children:e.jsx("button",{className:"bg-red-600 lg:px-7 lg:text-[18px] text-[12px] px-4 lg:py-3 py-2 rounded-lg text-white font-[600] cursor-pointer hover:bg-red-700",onClick:h,children:"Keluar"})})]})]}),children:[e.jsx(j,{title:"Dashboard"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"py-6 px-9 text-gray-900",children:[e.jsx("h3",{className:"font-poppins font-[600] lg:text-[40px] text-[30px] my-4 text-center",children:"Daftar Produk"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 mt-12 lg:grid-cols-3 gap-4",children:a.map(t=>e.jsxs("div",{className:"border rounded-lg p-4 shadow-md",children:[e.jsx("img",{src:t.img_Url,alt:t.nama,className:"w-full h-auto mb-2"}),e.jsx("h4",{className:"text-md font-bold",children:t.nama}),e.jsxs("p",{className:"text-gray-700",children:["Harga: Rp ",parseFloat(t.harga).toLocaleString()]}),e.jsxs("div",{className:"flex justify-start items-center gap-4 mt-4",children:[e.jsx(i,{href:route("edit",t.id),children:e.jsx("button",{className:"bg-blue-600 px-8 py-2 rounded-lg text-white font-[600] hover:bg-blue-700",children:"Edit"})}),e.jsx("button",{onClick:()=>u(t.id),className:"bg-red-600 px-8 py-2 rounded-lg text-white font-[600] hover:bg-red-700",children:"Hapus"})]}),e.jsx("h5",{className:"font-semibold mt-4",children:"Komentar:"}),e.jsx("div",{className:"mt-2",children:d.filter(s=>s.product_id===t.id).map(s=>e.jsxs("div",{className:"flex justify-between items-center border-b py-2",children:[e.jsx("p",{children:s.comment}),e.jsx("button",{onClick:()=>p(s.id),className:"bg-red-600 px-4 py-2 text-[14px] rounded-lg text-white font-[600] hover:bg-red-700",children:"Hapus"})]},s.id))})]},t.id))})]})})})})]})}export{v as default};
