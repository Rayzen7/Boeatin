import{r as n,q as v,W as S,j as e,Y as C,a as g}from"./app-lY45AIX9.js";import{S as i}from"./sweetalert2.all-opkTSmCx.js";const B=()=>{const[a,d]=n.useState(null),[o,x]=n.useState(1),[u,b]=n.useState([]),{id:c,product:l}=v().props,{data:p,setData:h,post:f}=S({comment:""});n.useEffect(()=>{l?(d(l),m(l.id)):(async()=>{try{if(!c)throw new Error("Product ID is missing");const s=await fetch(`/products/${c}`);if(!s.ok)throw new Error("Failed to fetch product");const r=await s.json();d(r),m(r.id)}catch(s){console.error("Error fetching product:",s)}})()},[c,l]);const m=async t=>{try{const s=await fetch(`/products/${t}/comments`,{method:"GET"});if(!s.ok)throw new Error("Failed to fetch comments");const r=await s.json();b(r)}catch(s){console.error("Error fetching comments:",s)}},w=t=>{t.preventDefault(),f(`/products/${a.id}/comments`,{comment:p.comment,onSuccess:()=>{h("comment",""),m(a.id),i.fire("Success","Comment posted successfully!","success")},onError:()=>{i.fire("Error","Failed to post comment","error")}})},j=()=>x(t=>t+1),y=()=>x(t=>t>1?t-1:1),N=()=>{const t=parseFloat(a.harga)*o;i.fire({title:`Apakah kamu yakin membeli ${a.nama} dengan jumlah ${o}?`,text:`Total harga: Rp ${t.toLocaleString()}`,icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, beli sekarang!",cancelButtonText:"Batal",customClass:{title:"text-[26px]",confirmButton:"bg-red-600 text-white hover:bg-red-700",cancelButton:"bg-gray-300 text-black hover:bg-gray-400"}}).then(s=>{if(s.isConfirmed){const r=`Saya membeli ${a.nama} sebanyak ${o} dengan harga Rp ${t.toLocaleString()}`,k=`https://wa.me/6281219538787?text=${encodeURIComponent(r)}`;window.open(k,"_blank")}})};return a?e.jsxs("div",{className:"w-full p-6 bg-gray-100",children:[e.jsx(C,{title:`Buy ${a.nama}`}),e.jsx(g,{href:route("home"),children:e.jsxs("div",{className:"flex justify-start items-center gap-3 max-w-7xl mx-auto mt-5 lg:mb-12 mb-10",children:[e.jsx("i",{className:"bx bx-left-arrow-alt text-red-600 text-[28px] lg:text-[37px] font-[600]"}),e.jsx("p",{className:"font-poppins font-[600] text-red-600 text-[25px] lg:text-[32px]",children:"Kembali"})]})}),e.jsxs("p",{className:"max-w-7xl mx-auto lg:text-[20px] text-[15px] mb-5 font-poppins italic font-[400]",children:["Home > Beli > ",a.nama]}),e.jsxs("div",{className:"max-w-7xl mx-auto bg-white lg:p-8 p-2 rounded-lg shadow-lg",children:[e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"w-full md:w-1/2 p-4",children:e.jsx("img",{src:a.img_Url,alt:a.nama,className:"w-full h-auto rounded-lg border-2 border-gray-200"})}),e.jsxs("div",{className:"w-full md:w-1/2 p-4",children:[e.jsx("h1",{className:"lg:text-4xl text-[26px] font-semibold mb-4",children:a.nama}),e.jsx("p",{className:"lg:text-lg text-[16px] mb-4 text-gray-700",children:a.deskripsi}),e.jsxs("p",{className:"lg:text-3xl text-[22px] font-bold text-red-600 mb-4",children:["Rp ",parseFloat(a.harga).toLocaleString()]}),e.jsxs("div",{className:"flex justify-between items-center mb-6 border-2 border-gray-300 rounded-md overflow-hidden",children:[e.jsx("button",{onClick:y,className:"lg:px-12 px-1 lg:w-auto w-[40px] py-2 bg-gray-200 text-lg font-semibold hover:bg-gray-300",children:"-"}),e.jsx("input",{type:"text",value:o,readOnly:!0,className:"w-auto text-center border-0 outline-none py-1"}),e.jsx("button",{onClick:j,className:"lg:px-12 px-1 lg:w-auto w-[40px] py-2 bg-gray-200 text-lg font-semibold hover:bg-gray-300",children:"+"})]}),e.jsx("button",{onClick:N,className:"bg-red-600 hover:bg-red-700 text-white py-3 w-full rounded-lg font-semibold lg:mt-0 mt-12 text-lg mb-4",children:"Beli Sekarang"}),e.jsx(g,{href:a.link,className:"text-blue-500 underline",children:e.jsx("p",{className:"lg:text-start text-center",children:"Lihat Produk lebih lanjut"})})]})]}),e.jsxs("div",{className:"lg:mt-8 mt-12 lg:px-0 px-3",children:[e.jsx("h2",{className:"lg:text-[30px] text-[26px] font-semibold mb-4 text-red-600",children:"Komentar"}),u.length===0?e.jsx("p",{children:"Tidak ada komentar untuk produk ini."}):e.jsx("ul",{className:"lg:mt-12 mt-9",children:u.map(t=>e.jsxs("li",{className:"border-b mb-2 pb-2",children:[e.jsx("p",{className:"font-semibold lg:text-[22px] text-[20px]",children:"Pembeli"}),e.jsx("p",{className:"lg:text-[18px] text-[14px]",children:t.comment})]},t.id))})]}),e.jsxs("form",{onSubmit:w,className:"mt-6 lg:px-0 px-3 pb-5 lg:pb-0",children:[e.jsx("textarea",{value:p.comment,onChange:t=>h("comment",t.target.value),rows:"4",placeholder:"Tulis komentar...",className:"w-full p-2 border rounded",required:!0}),e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded mt-2",children:"Kirim Komentar"})]})]})]}):e.jsx("div",{children:"Loading..."})};export{B as default};
